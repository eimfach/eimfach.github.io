window.onload=function(){var e=function(e){return e.initializeApp({apiKey:"AIzaSyAG7ivSRnQUGb5xTuzztDM9YOzGY1IZKJc",authDomain:"blind-game-poll.firebaseapp.com",databaseURL:"https://blind-game-poll.firebaseio.com",projectId:"blind-game-poll",storageBucket:"blind-game-poll.appspot.com",messagingSenderId:"72922648857",appId:"1:72922648857:web:52ad5ce5e05b68bf4c3588"}),{query:n,initialPoll:t().once("value").then(function(e){return e.val()}),getCurrentPoll:t,getInsertKey:function(e){return n().child(e).push().key}};function n(n){return e.database().ref(n)}function t(){return n("/polls/0")}}(window.firebase);!function(e,n){n.then(function(n){var t=n.checkboxes.map(function(e){var n=e.querySelector("input[type=checkbox]");return n});n.submitButton.onclick=function(n,t){return function(){e.getCurrentPoll().once("value",function(r){var u=r.val(),i=function(e){return e.reduce(function(e,n){return n.checked?e+1:e},0)}(n),c=t.value;if(function(e){if(2!=e)return alert("Du hast zwei Stimmen ! Du hast aber "+e+" checkboxen aktiviert."),!1;return!0}(i)&&function(e){if(16!=e.length)return alert("Dein Truhenschluessel muss exakt 16 Zeichen haben, aktuell hast du "+e.length+" Zeichen."),!1;return!0}(c)&&function(e,n){var t=function(e,n){return e.keys.some(function(e){return n(e.value)})}(e,function(e){return e===n}),r=function(e,n){return e.items.every(function(e){return Object.keys(e.votes).every(function(t){return n(e.votes[t])})})}(e,function(e){return e!==n});if(!t||!r)return alert("Dein Truhenschluessel ist ungueltig oder wurde schon benutzt !"),!1;return!0}(u,c)){var o=function(e){return e.reduce(function(e,n){return n.checked?e.concat([n.value]):e},[])}(n),a=function(n,t,r){var u={};return t.forEach(function(t){var i=function(e,n){var t=-1;return e.items.some(function(e){if(t+=1,e.name===n)return!0}),t}(n,t),c=e.getInsertKey("polls/0/items/"+i+"/votes");u["polls/0/items/"+i+"/votes/"+c]=r}),u}(u,o,c);"object"==typeof a&&e.query().update(a,function(e){e?alert("Deine Abstimmung war nicht erfolgreich, bitte versuche es spaeter nochmal !"):alert("Deine Abstimmung war erfolgreich !")})}}).catch(function(){alert("Bitte pr√ºfe deine Internetverbindung ...")})}}(t,n.pollAuthElement)}).catch(function(){alert("Die Daten fuer die Abstimmung konnten nicht geladen werden, ist deine Internetverbindung ok ?")})}(e,function(e){var n=document.getElementById("interactive-blind-poll");return e.initialPoll.then(function(e){var i,c,o,a=function(e){return e.items.map(function(e){return e.name})}(e),l=(i="pollAuthKey",c="truhenschluessel-eingabe",(o=t()).type="text",o.id=i,o.name=c,o),s=r("pollAuthKey","Truhenschluessel : "),f=a.map(function(e){var n,i,c,o=e.toLowerCase().replace(" ","-"),a=function(e,n,r){var u=t();return u.type="checkbox",u.id=e,u.name=n,u.value=r,u}(o,o,e),l=((n=r(o,e)).className="padded",n);return i=[a,l],u(c=document.createElement("div"),i),c}),d=function(e,n,t){var r=document.createElement("button");return r.id=e,r.name=n,r.appendChild(document.createTextNode(t)),r}("absenden","absenden","Absenden");return n.innerHTML="",u(n,[s,l].concat(f).concat([d])),{submitButton:d,checkboxes:f,pollAuthElement:l}});function t(){return document.createElement("input")}function r(e,n){var t=document.createElement("label");return t.htmlFor=e,t.appendChild(document.createTextNode(n)),t}function u(e,n){n.forEach(function(n){e.appendChild(n)})}}(e))};