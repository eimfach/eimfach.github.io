window.onload=function(){var e,n=((e=window.firebase).initializeApp({apiKey:"AIzaSyAG7ivSRnQUGb5xTuzztDM9YOzGY1IZKJc",authDomain:"blind-game-poll.firebaseapp.com",databaseURL:"https://blind-game-poll.firebaseio.com",projectId:"blind-game-poll",storageBucket:"blind-game-poll.appspot.com",messagingSenderId:"72922648857",appId:"1:72922648857:web:52ad5ce5e05b68bf4c3588"}),e.database().ref("/polls/0").once("value").then(function(e){return e.val()}));!function(e,n){var t=document.getElementById("interactive-blind-poll");n.then(function(n){t.innerHTML="";var a=n.items.map(function(e){return e.name}),i=document.createElement("input");i.type="text",i.id="pollKey",i.name="truhenschluessel-eingabe";var r=document.createElement("label");r.htmlFor="pollKey",r.appendChild(document.createTextNode("Truhenschluessel : "));var l=a.map(function(e){var n=e.toLowerCase().replace(" ","-"),t=document.createElement("div"),a=document.createElement("input");a.type="checkbox",a.id=n,a.name=n,a.value=e;var i=document.createElement("label");return i.htmlFor=n,i.className="padded",i.appendChild(document.createTextNode(e)),t.appendChild(a),t.appendChild(i),t});t.appendChild(r),t.appendChild(i),l.forEach(e=>{t.appendChild(e)});var o=document.createElement("button");o.appendChild(document.createTextNode("Absenden")),t.appendChild(o),e.database().ref("/polls/0").on("value",function(n){var t=n.val();o.onclick=function(){var n=0,a=l.map(function(e){var t=e.querySelector("input[type=checkbox]");return t.checked&&(n+=1),[t,t.checked]});if(2==n){var r=i.value;if(16!=r.length)alert("Dein Truhenschluessel muss exakt 16 Zeichen haben, aktuell hast du "+r.length+" Zeichen.");else{var o=!1,c=!0;if(t.keys.forEach(function(e){r===e.value&&(o=!0,t.items.forEach(function(e){"object"==typeof e.votes&&Object.keys(e.votes).forEach(function(n){e.votes[n]===r&&(c=!1)})}))}),o&&c){var d=[];a.forEach(function(e){!0===e[1]&&d.push(e[0].value)});var u={};d.forEach(function(e){var n=-1;t.items.some(function(t){if(n+=1,t.name===e)return!0});var a=window.firebase.database().ref().child("polls/0/items/"+n+"/votes").push().key;u["polls/0/items/"+n+"/votes/"+a]=r}),Object.keys(u).length>0?e.database().ref().update(u,function(e){e?alert("Deine Abstimmung war nicht erfolgreich, bitte versuche es spaeter nochmal !"):alert("Deine Abstimmung war erfolgreich !")}):alert("Es gab einen Fehler bei der Uebertragung deiner Abstimmung, bitte versuche es spaeter nochmal ! ")}else alert("Dein Truhenschluessel ist ungueltig oder wurde schon benutzt !")}}else alert("Du hast zwei Stimmen ! Du hast aber "+n+" checkboxen aktiviert.")}})}).catch(function(){t.innerHTML="Die Daten fuer die Abstimmung konnten nicht geladen werden, ist deine Internetverbindung ok ?",alert("Die Daten fuer die Abstimmung konnten nicht geladen werden, ist deine Internetverbindung ok ?")})}(window.firebase,n)};